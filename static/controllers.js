var MessagesControllers = angular.module('MessagesControllers', []);MessagesControllers.controller('MessagesCtrl', ['$scope', '$dragon', function ($scope, $dragon) {    $scope.messagesItems = [];    $scope.channel = 'messages';    $dragon.onReady(function() {        $dragon.subscribe('messages-item', $scope.channel).then(function(response) {            $scope.dataMapper = new DataMapper(response.data);        });        //        //$dragon.getSingle('messages-item', {id:1}).then(function(response) {        //    $scope.messagesItems = response.data;        //});    });    $dragon.onChannelMessage(function(channels, message) {        if (indexOf.call(channels, $scope.channel) > -1) {            $scope.$apply(function() {                $scope.dataMapper.mapData($scope.messagesItems, message);            });        }    });    $scope.itemDone = function(item) {        item.done = true != item.done;        $dragon.update('messages-item', item);    }}]);